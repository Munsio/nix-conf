# My new nixOS configuration

## Development

### Building and Testing

Create a `/result` folder containing all the configuration files generated by home-manager
```bash
nix build .#nixosConfigurations.whirl.config.home-manager.users.martin.home.activationPackage
```

Create a `/result` folder containing all the configuration files generated by nixOS system
```bash
nix build .#nixosConfigurations.whirl.config.system.build.toplevel
```

To see if a program got installed in the new version use
```bash
nix store diff-closures /run/current-system ./result/ | grep ghostty
```

### Formatting and Linting

This project uses several tools to ensure code quality:

- **alejandra**: Formats Nix code according to a consistent style
- **statix**: Lints Nix code for common issues and anti-patterns
- **deadnix**: Identifies unused code in Nix files

#### Running Formatters and Linters

You can run these tools using the development shell provided in the flake:

```bash
# Enter the development shell
nix develop

# Format all Nix files
alejandra .

# Check formatting without making changes
alejandra --check .

# Run statix to check for Nix anti-patterns
statix check .

# Run deadnix to find unused code
deadnix --fail .
```

Alternatively, you can run them directly without entering the shell:

```bash
# Format all Nix files
nix-shell -p alejandra --run "alejandra ."

# Check for Nix anti-patterns
nix-shell -p statix --run "statix check ."

# Find unused code
nix-shell -p deadnix --run "deadnix --fail ."
```

These checks are also run automatically in the CI pipeline for all pull requests and pushes to the main branch.
